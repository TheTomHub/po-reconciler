<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Chandlr</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script defer="defer" src="taskpane.f27be91f.js"></script></head><body><div id="app"><header><h1>Chandlr</h1></header><nav class="tab-bar"><button class="tab active" data-tab="reconcile">Reconcile</button> <button class="tab" data-tab="actions" disabled="disabled" title="Run reconciliation first">Actions</button> <button class="tab" data-tab="tools">Tools</button></nav><main><div class="tab-panel active" id="panel-reconcile"><section class="step" id="step-po"><div class="step-header"><span class="step-number">1</span> <span class="step-title">Upload Customer PO</span></div><div class="step-body"><label class="file-upload-btn" for="po-file-input">Choose File</label> <input type="file" id="po-file-input" accept=".xlsx,.xls,.csv,.pdf" hidden> <span class="status" id="po-status">No file selected</span></div><div class="step-body" style="margin-top:6px"><button id="extract-btn" class="btn btn-sm" disabled="disabled">Extract to Staging Sheet</button> <span class="status" id="extract-status"></span></div><div id="validation-section" class="validation-section" hidden><div id="validation-badge" class="validation-badge"></div><div id="validation-details" class="validation-details" hidden><pre id="validation-report"></pre></div></div><p class="step-hint">Zendesk HTML POs: save as .xlsx first.</p><div id="manual-columns-po" class="manual-columns" hidden><p class="warning-text">Could not auto-detect columns. Please select:</p><div class="select-row"><label for="po-sku-col">SKU Column:</label> <select id="po-sku-col"></select></div><div class="select-row"><label for="po-price-col">Price Column:</label> <select id="po-price-col"></select></div><div class="select-row"><label for="po-name-col">Name Column (optional):</label> <select id="po-name-col"><option value="">— None —</option></select></div><div class="select-row"><label for="po-qty-col">Qty Column (optional):</label> <select id="po-qty-col"><option value="">— None —</option></select></div><button id="apply-po-columns" class="btn btn-sm">Apply</button></div></section><section class="step" id="step-erp"><div class="step-header"><span class="step-number">2</span> <span class="step-title">Select ERP Data</span></div><div class="step-body" id="erp-range-body"><button id="select-range-btn" class="btn">Load Selection</button> <span class="status" id="erp-status">Select ERP data in Excel, then click Load</span></div><div id="manual-columns-erp" class="manual-columns" hidden><p class="warning-text">Could not auto-detect columns. Please select:</p><div class="select-row"><label for="erp-sku-col">SKU Column:</label> <select id="erp-sku-col"></select></div><div class="select-row"><label for="erp-price-col">Price Column:</label> <select id="erp-price-col"></select></div><div class="select-row"><label for="erp-name-col">Name Column (optional):</label> <select id="erp-name-col"><option value="">— None —</option></select></div><div class="select-row"><label for="erp-qty-col">Qty Column (optional):</label> <select id="erp-qty-col"><option value="">— None —</option></select></div><button id="apply-erp-columns" class="btn btn-sm">Apply</button></div></section><section class="step" id="step-settings"><div class="step-header"><span class="step-number">&#9881;</span> <span class="step-title">Settings</span></div><div class="step-body"><label for="tolerance-input">Tolerance:</label> <input type="number" id="tolerance-input" value="0.02" min="0" step="0.01"> <label for="currency-select">Currency:</label> <select id="currency-select"><option value="GBP" selected="selected">GBP (£)</option><option value="USD">USD ($)</option><option value="EUR">EUR (€)</option></select></div></section><div class="action-section"><button id="reconcile-btn" class="btn btn-primary" disabled="disabled">Reconcile</button></div><div id="progress-section" hidden><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><span class="progress-text" id="progress-text">Processing...</span></div><section id="results-section" hidden><h2>Results</h2><div class="results-grid"><div class="result-card"><span class="result-label">Total Items</span> <span class="result-value" id="result-total">—</span></div><div class="result-card match"><span class="result-label">Matches</span> <span class="result-value" id="result-matches">—</span></div><div class="result-card tolerance"><span class="result-label">Within Tolerance</span> <span class="result-value" id="result-tolerances">—</span></div><div class="result-card exception"><span class="result-label">Exceptions</span> <span class="result-value" id="result-exceptions">—</span></div><div class="result-card warning"><span class="result-label">Warnings</span> <span class="result-value" id="result-warnings">—</span></div><div class="result-card exposure"><span class="result-label">Total Exposure</span> <span class="result-value" id="result-exposure">—</span></div></div><div id="next-steps" class="next-steps" hidden><p class="next-steps-label">Next steps</p><div id="next-steps-list" class="next-steps-list"></div></div></section><section id="browser-results-table" hidden><h2>Reconciliation Detail</h2><div class="table-scroll"><table id="results-table"></table></div></section></div><div class="tab-panel" id="panel-actions"><h2>Post-Reconciliation Actions</h2><p class="tab-hint" id="actions-hint">Run reconciliation first to unlock actions.</p><div id="actions-content" hidden><div id="actions-workflow" class="workflow-steps"><div class="workflow-step" id="wf-credit" hidden><span class="workflow-num">1</span><div class="workflow-body"><p class="workflow-title">Credit the original invoice</p><p class="workflow-desc">Full credit at PO prices — company policy</p><button id="credit-note-btn" class="btn btn-secondary">Generate Credit Note</button></div></div><div class="workflow-step" id="wf-reinvoice" hidden><span class="workflow-num">2</span><div class="workflow-body"><p class="workflow-title">Re-invoice at correct prices</p><p class="workflow-desc">New invoice using ERP prices</p><button id="reinvoice-btn" class="btn btn-secondary">Generate Re-Invoice</button></div></div><div class="workflow-step" id="wf-staging"><span class="workflow-num" id="wf-staging-num">1</span><div class="workflow-body"><p class="workflow-title">Create ERP staging sheet</p><p class="workflow-desc">Color-coded: green = enter, yellow = review, red = hold</p><button id="erp-staging-btn" class="btn btn-secondary">Generate ERP Staging</button></div></div><div class="workflow-step" id="wf-email"><span class="workflow-num" id="wf-email-num">2</span><div class="workflow-body"><p class="workflow-title">Notify the team</p><p class="workflow-desc">Email summary of exceptions to MDC</p><button id="email-btn" class="btn btn-secondary">Draft Exception Email</button></div></div></div><span class="status" id="action-status"></span><section id="email-section" hidden><h2>Email Draft</h2><pre id="email-draft"></pre><div class="email-actions"><button id="copy-email-btn" class="btn btn-sm">Copy to Clipboard</button> <a id="mailto-link" class="btn btn-sm btn-secondary" href="#">Open Email Client</a></div><span class="status" id="email-status"></span></section></div></div><div class="tab-panel" id="panel-tools"><h2>Price Intelligence</h2><p class="tab-hint" id="tools-hint">History builds automatically as you reconcile POs.</p><div id="history-summary" class="history-summary" hidden><div class="history-stats"><span id="history-records">0</span> records &middot; <span id="history-skus">0</span> SKUs &middot; <span id="history-runs">0</span> runs</div></div><div class="action-section"><button id="dashboard-btn" class="btn btn-primary" disabled="disabled">Generate Dashboard</button> <span class="status" id="dashboard-status"></span></div><div id="predict-summary" hidden><div class="predict-metrics"><div class="result-card"><span class="result-label">Avg Price Drift</span> <span class="result-value" id="predict-drift">—</span></div><div class="result-card"><span class="result-label">Exception Rate</span> <span class="result-value" id="predict-exception-rate">—</span></div><div class="result-card warning"><span class="result-label">Anomalies</span> <span class="result-value" id="predict-anomalies">—</span></div><div class="result-card"><span class="result-label">Trending Up</span> <span class="result-value" id="predict-trending-up">—</span></div></div></div></div><div id="error-section" hidden><p class="error-text" id="error-message"></p></div></main></div></body></html>