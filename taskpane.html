<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PO Reconciler</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script defer="defer" src="taskpane.2585cdad.js"></script></head><body><div id="app"><header><h1>PO Reconciliation</h1></header><nav class="tab-bar"><button class="tab active" data-tab="reconcile">Reconcile</button> <button class="tab" data-tab="actions" disabled="disabled" title="Run reconciliation first">Actions</button></nav><main><div class="tab-panel active" id="panel-reconcile"><section class="step" id="step-po"><div class="step-header"><span class="step-number">1</span> <span class="step-title">Upload Customer PO</span></div><div class="step-body"><label class="file-upload-btn" for="po-file-input">Choose File</label> <input type="file" id="po-file-input" accept=".xlsx,.xls,.csv,.pdf" hidden> <span class="status" id="po-status">No file selected</span></div><div class="step-body" style="margin-top:6px"><button id="extract-btn" class="btn btn-sm" disabled="disabled">Extract to Staging Sheet</button> <span class="status" id="extract-status"></span></div><p class="step-hint">Zendesk HTML POs: save as .xlsx first.</p><div id="manual-columns-po" class="manual-columns" hidden><p class="warning-text">Could not auto-detect columns. Please select:</p><div class="select-row"><label for="po-sku-col">SKU Column:</label> <select id="po-sku-col"></select></div><div class="select-row"><label for="po-price-col">Price Column:</label> <select id="po-price-col"></select></div><div class="select-row"><label for="po-name-col">Name Column (optional):</label> <select id="po-name-col"><option value="">— None —</option></select></div><div class="select-row"><label for="po-qty-col">Qty Column (optional):</label> <select id="po-qty-col"><option value="">— None —</option></select></div><button id="apply-po-columns" class="btn btn-sm">Apply</button></div></section><section class="step" id="step-erp"><div class="step-header"><span class="step-number">2</span> <span class="step-title">Select ERP Data</span></div><div class="step-body" id="erp-range-body"><button id="select-range-btn" class="btn">Load Selection</button> <span class="status" id="erp-status">Select ERP data in Excel, then click Load</span></div><div id="manual-columns-erp" class="manual-columns" hidden><p class="warning-text">Could not auto-detect columns. Please select:</p><div class="select-row"><label for="erp-sku-col">SKU Column:</label> <select id="erp-sku-col"></select></div><div class="select-row"><label for="erp-price-col">Price Column:</label> <select id="erp-price-col"></select></div><div class="select-row"><label for="erp-name-col">Name Column (optional):</label> <select id="erp-name-col"><option value="">— None —</option></select></div><div class="select-row"><label for="erp-qty-col">Qty Column (optional):</label> <select id="erp-qty-col"><option value="">— None —</option></select></div><button id="apply-erp-columns" class="btn btn-sm">Apply</button></div></section><section class="step" id="step-settings"><div class="step-header"><span class="step-number">&#9881;</span> <span class="step-title">Settings</span></div><div class="step-body"><label for="tolerance-input">Tolerance:</label> <input type="number" id="tolerance-input" value="0.02" min="0" step="0.01"> <label for="currency-select">Currency:</label> <select id="currency-select"><option value="GBP" selected="selected">GBP (£)</option><option value="USD">USD ($)</option><option value="EUR">EUR (€)</option></select></div></section><div class="action-section"><button id="reconcile-btn" class="btn btn-primary" disabled="disabled">Reconcile</button></div><div id="progress-section" hidden><div class="progress-bar"><div class="progress-fill" id="progress-fill"></div></div><span class="progress-text" id="progress-text">Processing...</span></div><section id="results-section" hidden><h2>Results</h2><div class="results-grid"><div class="result-card"><span class="result-label">Total Items</span> <span class="result-value" id="result-total">—</span></div><div class="result-card match"><span class="result-label">Matches</span> <span class="result-value" id="result-matches">—</span></div><div class="result-card tolerance"><span class="result-label">Within Tolerance</span> <span class="result-value" id="result-tolerances">—</span></div><div class="result-card exception"><span class="result-label">Exceptions</span> <span class="result-value" id="result-exceptions">—</span></div><div class="result-card warning"><span class="result-label">Warnings</span> <span class="result-value" id="result-warnings">—</span></div><div class="result-card exposure"><span class="result-label">Total Exposure</span> <span class="result-value" id="result-exposure">—</span></div></div></section><section id="browser-results-table" hidden><h2>Reconciliation Detail</h2><div class="table-scroll"><table id="results-table"></table></div></section></div><div class="tab-panel" id="panel-actions"><h2>Post-Reconciliation Actions</h2><p class="tab-hint" id="actions-hint">Run reconciliation first to unlock actions.</p><div id="actions-content" hidden><div class="action-section"><button id="email-btn" class="btn btn-secondary">Draft Exception Email</button> <button id="credit-note-btn" class="btn btn-secondary" hidden>Generate Credit Note</button> <button id="reinvoice-btn" class="btn btn-secondary" hidden>Generate Re-Invoice</button></div><span class="status" id="action-status"></span><section id="email-section" hidden><h2>Email Draft</h2><pre id="email-draft"></pre><div class="email-actions"><button id="copy-email-btn" class="btn btn-sm">Copy to Clipboard</button> <a id="mailto-link" class="btn btn-sm btn-secondary" href="#">Open Email Client</a></div><span class="status" id="email-status"></span></section></div></div><div id="error-section" hidden><p class="error-text" id="error-message"></p></div></main></div></body></html>